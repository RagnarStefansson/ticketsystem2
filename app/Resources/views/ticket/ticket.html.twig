{% extends 'base.html.twig' %}

{% block body %}
    <div class="row">
        <div class="col-md-7">
            <ul>
                <li>Ticket-ID: {{ ticket.tid }}</li>
                <li>Titel: {{ ticket.titel }}</li>
                <li>Kunde: {{ getCustomerName(ticket.kid) }}</li>
                <li>Ansprechpartner: {{ ticket.contact }}</li>
                <li>Telefon/Ansprechpartner: {{ ticket.phone }}</li>
                <li>E-Mail/Ansprechpartner:{{ ticket.email }}</li>
                <li>Beschreibung: {{ ticket.freeform }}</li>
                <li>Verantwortlicher: {{ getResponsibleName(ticket.uid) }}</li>
                <li>Zeiten: {{ ticket.times }}</li>
                <li>Status: {{ ticket.status }}</li>
            </ul>
        </div>
        <div class="col-md-4">
            <div class="btn-group" role="group" aria-label="...">
                <a href="{{ path('ticketedit', {'tid': ticket.tid}) }}" type="button" data-toggle="tooltip" data-placement="bottom" title="Ticket bearbeiten" class="btn btn-default"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                <a href="{{ path('createprocess', {'tid': ticket.tid}) }}" type="button" data-toggle="tooltip" data-placement="bottom" title="Vorgang anhängen" class="btn btn-default"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></a>
                <button type="button" class="btn btn-danger" data-toggle="modal" data-toggle="tooltip" data-placement="bottom" title="Ticket Löschen" data-target="#myModal"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
            </div>
        </div>

        <div class="col-md-7">
            {% for vorgang in ticket.vorgang %}
                <li data-index="{{ loop.index0 }}" data-desc="{{ vorgang.titel }}" data-author="{{ vorgang.id }}" data-times="{{ vorgang.times }}" class="processlink">{{ vorgang.titel }} {{ vorgang.time }}</li>
            {% endfor %}
        </div>
        <div id="processinfo" class="col-md-4">
            <ul>
                <li>Author: <span id="process-author"></span></li>
                <li>Zeiten: <span id="process-times"></span> Stunden</li>
                <li>Beschreibung:<span id="process-desc"></span></li>
            </ul>
        </div>
    </div>
    <br>

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <form action="{{ path('deleteTicket') }}" method="post">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Ticket löschen</h4>
                    </div>
                    <div class="modal-body">
                        Möchtest du das Ticket wirklich löschen?
                        <input type="hidden" name="tid" value="{{ ticket.tid }}">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Abbrechen</button>
                        <input type="submit" class="btn btn-danger" value="Ticket löschen">
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function(){
            $('#processinfo ul').hide();
        });
        $('.processlink').click(function(){
            var desc = $(this).data('desc');
            var author = $(this).data('author');
            var times = $(this).data('times');
            $('#processinfo ul').fadeOut(function(){
                $('#process-author').empty().append(author);
                $('#process-times').empty().append(times);
                $('#process-desc').empty().append(desc);
            });
            $('#processinfo ul').fadeIn();
        });
    </script>

{% endblock %}
